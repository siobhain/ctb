{% extends "base.html" %}

{% block head_title %}Todo{% endblock %}

{% block content %}
<h2>Todo Board</h2>
<br>
<h5>
    {{ user.profile.firstname|capfirst }},  
    You can <button>Update</button> or <button>Remove</button> 
    your Tasks from the board below <br> Use 
    <a href="/create"><button>Add</button></a> to add a new Task
    {% if  tasks|length > 2 %} 
        <br> Did you know we have {{ tasks|length }} outstanding tasks today. 
    {%endif%}
</h5>
<div class="table-responsive">
<table class="table table-striped table-condensed"> 
    <thead>
        <tr>
            <th>Date</th>
            <th>Action or OwnedBy</th>
            <th>Category</th>
            <th>Task Description</th>  
        </tr>
    </thead>
    <tbody>  
        {% for task in tasks %}
            <tr>
                <td> {{ task.created_on|date:"d M" }} </td>
                <td>{% if task.created_by == user %}
                        <a href="/edit/{{ task.id }}"><button>Update</button></a>
                        <a href="/delete/{{task.id}}">
                            <button class="btn btn-danger" data-bs-toggle="tooltip" title="Delete cannot be undone">Delete Task</button>
                        </a>
                    {% else %}
                        {{ task.created_by.profile.firstname|capfirst }}
                        {{ task.created_by.profile.surname|capfirst }}
                    {% endif %}
                </td>
                <td> {{ task.get_category_display }} </td>
                <td> {{ task|capfirst }} </td>
            </tr>
        {% empty %}
            <td> {% now "d M" %} </td>
            <td> NO TASKS</td>
            <td> NO TASKS </td>
            <td> {{ user.profile.firstname|capfirst }}, Do you need to
                <a href="/create"><button>Add</button></a> 
            </td>   
        {% endfor %}
    </tbody>
</table>

{%endblock%}
{% block extrabody %}
# from https://www.w3schools.com/bootstrap5/bootstrap_tooltip
<script>
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
      return new bootstrap.Tooltip(tooltipTriggerEl)
    })
</script>
{% endblock %} -->